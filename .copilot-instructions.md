# AI Development Guidelines for HOPE

## Project Context
You are helping develop HOPE, a 2D puzzle platformer where the player controls a pole-balancing robot using only controller joysticks (no buttons). This document provides specific guidance for AI assistants working on this project.

## Core Principles

### 1. Stick-Only Input Constraint
- **NEVER** implement button inputs or keyboard controls
- **ALWAYS** use only left stick, right stick, and right stick click
- **VERIFY** that all interactions can be performed with these inputs
- **REJECT** any suggestions that require additional inputs

### 2. Physics-First Design
- **PRIORITIZE** realistic pole physics over convenience
- **IMPLEMENT** balance as a core challenge, not a gimmick
- **ENSURE** player failure feels fair and physics-based
- **AVOID** artificial difficulty or arbitrary failure conditions

### 3. Accessibility Through Design
- **PROVIDE** visual feedback for all audio cues
- **ENSURE** colorblind accessibility in all visual elements
- **IMPLEMENT** controller rumble for important feedback
- **DESIGN** for players who may have limited fine motor control

## Development Approach

### Test-Driven Development
1. **Write tests first** for each new mechanic
2. **Implement minimum viable version** to pass tests
3. **Refactor and polish** while maintaining test coverage
4. **Add integration tests** for complex interactions

### Code Organization
```
scripts/
├── player/
│   ├── HopeController.gd      # Main player controller
│   ├── PolePhysics.gd         # Pole simulation and balance
│   └── InputManager.gd        # Controller input handling
├── enemies/
│   ├── BaseEnemy.gd           # Shared enemy behaviors
│   ├── PatrolBot.gd           # Simple patrol enemy
│   └── SentryBot.gd           # Detection and shooting
├── environment/
│   ├── MovingPlatform.gd      # Dynamic platforms
│   ├── WindZone.gd            # Environmental forces
│   └── ElectricalField.gd     # Hazard areas
└── systems/
    ├── CameraController.gd    # Right stick camera control
    ├── AudioManager.gd        # Dynamic audio system
    └── GameManager.gd         # Scene transitions, saves
```

### Scene Structure
```
Main.tscn
├── Player/
│   ├── Hope (CharacterBody2D)
│   ├── Pole (RigidBody2D)
│   └── BalanceDetector (Area2D)
├── Environment/
│   ├── StaticGeometry
│   ├── MovingPlatforms
│   └── Hazards
├── Enemies/
│   └── [Enemy instances]
├── UI/
│   ├── BalanceIndicator
│   └── InteractionPrompts
└── Systems/
    ├── CameraRig
    ├── AudioSources
    └── GameLogic
```

## Implementation Guidelines

### Player Controller
```gdscript
# Example structure for HopeController.gd
extends CharacterBody2D

@export var max_speed: float = 100.0
@export var balance_threshold: float = 0.7
@export var pole_length: float = 150.0

var balance_state: float = 0.0
var pole_angle: float = 0.0
var is_stable: bool = true

func _ready():
    # Initialize pole physics
    # Set up input handling
    # Connect to balance system

func _physics_process(delta):
    handle_input()
    update_balance(delta)
    apply_movement(delta)
    check_failure_conditions()

func handle_input():
    # Left stick: movement and pole control
    # Right stick: camera and interaction
    # Implement dead zones and sensitivity
```

### Balance System
```gdscript
# Example balance calculation
func calculate_balance_state() -> float:
    var angle_factor = abs(pole_angle) / max_stable_angle
    var velocity_factor = velocity.length() / max_stable_velocity
    var external_factor = external_forces.length() / max_external_force
    
    return (angle_factor + velocity_factor + external_factor) / 3.0
```

### Enemy AI Patterns
```gdscript
# Base enemy structure
extends CharacterBody2D
class_name BaseEnemy

@export var detection_range: float = 200.0
@export var movement_speed: float = 80.0

func _ready():
    # Initialize AI state machine
    # Set up detection areas
    # Configure audio/visual feedback

func _physics_process(delta):
    update_ai_state()
    execute_behavior(delta)
    check_player_interaction()
```

## Testing Strategy

### Unit Tests
- **Balance calculations** with various inputs
- **Input mapping** for different controller types
- **Physics interactions** between pole and environment
- **Enemy AI states** and transitions

### Integration Tests
- **Complete room traversal** scenarios
- **Multi-enemy encounters** with various strategies
- **Environmental hazard** navigation
- **Story progression** and save/load functionality

### Playtesting Scenarios
1. **New Player Experience**: Can someone learn the controls intuitively?
2. **Accessibility**: Can players with motor limitations succeed?
3. **Difficulty Curve**: Does each room teach before it tests?
4. **Controller Compatibility**: Works with Xbox, PlayStation, generic gamepads?

## Common Pitfalls to Avoid

### Input Handling
- **DON'T** assume all controllers have identical stick sensitivity
- **DON'T** implement button fallbacks "just in case"
- **DON'T** ignore dead zone configuration
- **DO** test with multiple controller types

### Physics Implementation
- **DON'T** fake physics with animations
- **DON'T** make balance too forgiving or too punishing
- **DON'T** ignore momentum and inertia
- **DO** make physics feel consistent and predictable

### Level Design
- **DON'T** create pixel-perfect precision requirements
- **DON'T** rely on trial-and-error gameplay
- **DON'T** hide critical information from the player
- **DO** provide multiple solution paths when possible

## Code Quality Standards

### GDScript Style
- Use `snake_case` for variables and functions
- Use `PascalCase` for classes and scenes
- Comment complex physics calculations
- Use type hints for all function parameters and returns

### Performance Requirements
- Maintain 60fps on target platforms
- Optimize physics calculations for real-time performance
- Use object pooling for frequently spawned objects (particles, projectiles)
- Profile regularly and address bottlenecks

### Documentation
- Document all public functions with clear parameter descriptions
- Include usage examples for complex systems
- Maintain up-to-date scene documentation
- Comment any non-obvious game design decisions

## Debugging and Development Tools

### Debug Visualizations
- **Balance State**: Visual indicator of current balance value
- **Pole Physics**: Show forces and collision points
- **Enemy Detection**: Visualize detection ranges and states
- **Input Values**: Display raw stick inputs and processed values

### Development Cheats
- **Room Skip**: Quick navigation for testing
- **Invincibility**: Disable failure conditions temporarily
- **Physics Tweaking**: Runtime adjustment of balance parameters
- **Camera Freedom**: Unlock camera for level inspection

## Story Integration

### Narrative Delivery
- **Environmental Storytelling**: Use visual details, not text
- **Audio Logs**: Brief, optional story elements
- **Character Animation**: HOPE's body language conveys emotion
- **World State**: Environment reflects story progression

### Character Development
- **HOPE's Growth**: Reflected in improved balance and confidence
- **Relationship Uncertainty**: Shown through hesitation and curiosity
- **Robot Hostility**: Demonstrated through behavior, not exposition
- **Resolution**: Player choice influences final relationship dynamic

## When to Ask for Help

### Technical Issues
- Physics calculations producing unexpected results
- Controller input not responding correctly
- Performance drops below 60fps
- Save/load system corruption

### Design Questions
- Balance difficulty feels unfair or too easy
- New mechanic doesn't fit stick-only constraint
- Story element conflicts with established lore
- Accessibility concern with proposed feature

### Implementation Decisions
- Multiple valid approaches to a problem
- Uncertainty about Godot best practices
- Complex system interactions
- Platform-specific considerations

Remember: The goal is to create a unique, accessible, and emotionally engaging experience that showcases the potential of constrained input design. Every decision should serve the core vision of HOPE's journey to find her researcher while mastering the art of balance.